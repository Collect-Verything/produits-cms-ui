

Pour faciliter le lancement de lâ€™application en **mode production**, on dÃ©finit un service `server` dans `docker-compose.yaml`.  
Ce service utilise le `Dockerfile` multi-stage (React + Nginx) et publie lâ€™application sur un port accessible depuis lâ€™hÃ´te.

---

## ðŸ”¹ Extrait du `docker-compose.yaml`

```yaml
services:
  server:
    build:
      context: .
    environment:
      NODE_ENV: production
    ports:
      - 8000:8080
```

---

## ðŸ”¹ Explications

- **`build.context: .`**  
    â†’ Indique que le `Dockerfile` de production (multi-stage build) doit Ãªtre utilisÃ© Ã  la racine du projet.
    
- **`environment.NODE_ENV: production`**  
    â†’ DÃ©finit lâ€™environnement Ã  `production`.  
    MÃªme si Create React App utilise dÃ©jÃ  `NODE_ENV=production` lors de `npm run build`, cette variable reste utile pour forcer un comportement cohÃ©rent cÃ´tÃ© conteneur.
    
- **`ports: - 8000:8080`**  
    â†’ Mappe le port **8080 interne** (Nginx dans le conteneur) sur le port **8000 externe** de la machine hÃ´te.  
    â†’ Lâ€™application sera accessible sur [http://localhost:8000](http://localhost:8000/).
    

---

## ðŸ”¹ Commandes utiles

### Lancer le service en mode production :

```bash
docker compose up server
```

ðŸ‘‰ Cela :

1. Construit lâ€™image avec le `Dockerfile` multi-stage.
2. Lance Nginx dans un conteneur.
3. Expose lâ€™app sur `http://localhost:8000`.
    

---

### ArrÃªter et nettoyer le conteneur :

```bash
docker compose down
```

---

## ðŸ”¹ RÃ©sumÃ©

- Le service `server` est dÃ©diÃ© Ã  la **prod**.
- Il se base sur le `Dockerfile` multi-stage (`builder` + `nginx`).
- `docker compose up server` permet de lancer rapidement lâ€™application optimisÃ©e, servie par Nginx, sans Ã©crire une longue commande `docker run`.
    
