
## 5.3. Exemples de configuration (build args dynamiques)

### Exemple 1 : DÃ©ploiement utilisateur `usertest`

Payload envoyÃ© :

```json
{
  "event_type": "deploy-site",
  "client_payload": {
    "primary": "#ff0000",
    "secondary": "#00ff00",
    "titreSite": "Site Rouge & Vert",
    "user": "usertest"
  }
}
```

Pipeline â†’ crÃ©e et dÃ©ploie :

- Image : `cansefr/client-cms-usertest`.
- Conteneur : `client-cms-usertest`.
- Accessible sur : `http://<IP_SERVEUR>` (port 80).
    

---

### Exemple 2 : Nouvel utilisateur `client42`

Payload :

```json
{
  "event_type": "deploy-site",
  "client_payload": {
    "primary": "#123456",
    "secondary": "#654321",
    "titreSite": "Client 42",
    "user": "client42"
  }
}
```

Pipeline â†’ crÃ©e et dÃ©ploie :

- Image : `cansefr/client-cms-client42`.
- Conteneur : `client-cms-client42`.
- Accessible sur : `http://<IP_SERVEUR>`.
    

---

## âœ… RÃ©sumÃ©

- **DÃ©clenchement** : via `repository_dispatch` (requÃªte API).
- **Build** : lâ€™image est gÃ©nÃ©rÃ©e avec des **variables dynamiques** (`--build-arg`).
- **Push** : upload de lâ€™image sur Docker Hub.
- **Deploy** : connexion SSH au VPS, installation de Docker si besoin, lancement du conteneur.
- **Nom & image uniques** : basÃ©s sur `client_payload.user`.
    

ğŸ‘‰ GrÃ¢ce Ã  ce workflow, tu as une **chaÃ®ne complÃ¨te CI/CD** :  
Frontend â†’ envoi dâ€™un payload â†’ GitHub Actions â†’ build & push Docker â†’ dÃ©ploiement auto sur VPS.

