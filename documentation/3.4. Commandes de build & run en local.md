
Une fois ton **Dockerfile multi-stage** et ton `nginx.conf` prÃªts, tu peux tester ton application en **mode production** directement sur ta machine.  
Voici les commandes essentielles.

---

## ğŸ”¹ Ã‰tape 1 : Build de lâ€™image

Construire lâ€™image avec les variables dâ€™environnement injectÃ©es :

```bash
docker build \
  --build-arg REACT_APP_PRIMARY="#f542c2" \
  --build-arg REACT_APP_SECONDARY="#fcba03" \
  --build-arg REACT_APP_TITRE_SITE="titretest" \
  --build-arg REACT_APP_USER="usertest" \
  -t client-cms .
```

- `--build-arg` : permet de passer les variables **REACT_APP_*** qui seront intÃ©grÃ©es au moment du `npm run build`.
- `-t client-cms` : donne un nom (`client-cms`) Ã  lâ€™image pour la retrouver facilement.
    
âš ï¸ Si tu ne fournis pas de `--build-arg`, Docker utilisera les valeurs dÃ©finies dans ton fichier `.env` (ou bien les `ARG` par dÃ©faut dans le `Dockerfile`).

---

## ğŸ”¹ Ã‰tape 2 : Lancer le conteneur

ExÃ©cuter lâ€™image et exposer lâ€™app en local :
```bash
docker run -p 8080:8080 client-cms
```

- `-p 8080:8080` : mappe le port **8080 interne (Nginx)** sur le port **8080 de ta machine**.
- `client-cms` : nom de lâ€™image buildÃ©e.
    

ğŸ‘‰ Lâ€™application est maintenant disponible sur [http://localhost:8080](http://localhost:8080/).

---

## ğŸ”¹ Ã‰tape 3 : Utiliser Docker Compose

Tu peux aussi lancer ton service dÃ©fini dans `docker-compose.yaml` :
```bash
docker compose up server
```

- Cela va :
    1. Rebuild lâ€™image si nÃ©cessaire (basÃ©e sur ton `Dockerfile` multi-stage).
    2. Lancer un conteneur avec Nginx sur le port **8000** (selon ton `docker-compose.yaml`).
        
ğŸ‘‰ Lâ€™application sera dispo sur [http://localhost:8000](http://localhost:8000/).

---

## ğŸ”¹ Ã‰tape 4 : Nettoyer les conteneurs

ArrÃªter et supprimer les conteneurs + rÃ©seau associÃ© :

```bash
docker compose down
```

---

## âœ… RÃ©sumÃ©

- `docker build ...` â†’ construit lâ€™image avec les bonnes variables.
- `docker run -p 8080:8080 client-cms` â†’ lance le conteneur en prod (local).
- `docker compose up server` â†’ alternative plus pratique, basÃ©e sur `compose.yaml`.
- `docker compose down` â†’ arrÃªte tout proprement.
    
