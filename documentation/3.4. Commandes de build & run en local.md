
Une fois ton **Dockerfile multi-stage** et ton `nginx.conf` prêts, tu peux tester ton application en **mode production** directement sur ta machine.  
Voici les commandes essentielles.

---

## 🔹 Étape 1 : Build de l’image

Construire l’image avec les variables d’environnement injectées :

```bash
docker build \
  --build-arg REACT_APP_PRIMARY="#f542c2" \
  --build-arg REACT_APP_SECONDARY="#fcba03" \
  --build-arg REACT_APP_TITRE_SITE="titretest" \
  --build-arg REACT_APP_USER="usertest" \
  -t client-cms .
```

- `--build-arg` : permet de passer les variables **REACT_APP_*** qui seront intégrées au moment du `npm run build`.
- `-t client-cms` : donne un nom (`client-cms`) à l’image pour la retrouver facilement.
    
⚠️ Si tu ne fournis pas de `--build-arg`, Docker utilisera les valeurs définies dans ton fichier `.env` (ou bien les `ARG` par défaut dans le `Dockerfile`).

---

## 🔹 Étape 2 : Lancer le conteneur

Exécuter l’image et exposer l’app en local :
```bash
docker run -p 8080:8080 client-cms
```

- `-p 8080:8080` : mappe le port **8080 interne (Nginx)** sur le port **8080 de ta machine**.
- `client-cms` : nom de l’image buildée.
    

👉 L’application est maintenant disponible sur [http://localhost:8080](http://localhost:8080/).

---

## 🔹 Étape 3 : Utiliser Docker Compose

Tu peux aussi lancer ton service défini dans `docker-compose.yaml` :
```bash
docker compose up server
```

- Cela va :
    1. Rebuild l’image si nécessaire (basée sur ton `Dockerfile` multi-stage).
    2. Lancer un conteneur avec Nginx sur le port **8000** (selon ton `docker-compose.yaml`).
        
👉 L’application sera dispo sur [http://localhost:8000](http://localhost:8000/).

---

## 🔹 Étape 4 : Nettoyer les conteneurs

Arrêter et supprimer les conteneurs + réseau associé :

```bash
docker compose down
```

---

## ✅ Résumé

- `docker build ...` → construit l’image avec les bonnes variables.
- `docker run -p 8080:8080 client-cms` → lance le conteneur en prod (local).
- `docker compose up server` → alternative plus pratique, basée sur `compose.yaml`.
- `docker compose down` → arrête tout proprement.
    
